<div class="space-top-30"></div>

<button (click)="execute()" type="button" class="btn btn-success" [disabled]="executionInfo?.running"><i class="fa fa-play-circle"></i> Run Test</button>
<button *ngIf="executionInfo?.processOutput?.length"
        type="button"
        class="btn btn-default pull-right"
        (click)="openConsole()">
  <i class="fa fa-newspaper-o"></i> View logs
</button>

<div *ngIf="executionInfo; else noExecution">
  <h2 class="sub-header">Exchanged messages</h2>

  <div class="table-responsive">
    <table class="table table-hover">
      <thead>
      <tr>
        <th width="30">Type</th>
        <th>Message</th>
      </tr>
      </thead>
      <tbody>
      <tr *ngIf="!executionInfo.messages || executionInfo.messages?.length == 0">
        <td>
          <i *ngIf="!executionInfo.running" class="fa fa-envelope-o">&nbsp;</i>
          <img *ngIf="executionInfo.running" class="ajax-loader" src="assets/images/ajax-loader.gif" style="width: 1.3em;"/>
        </td>
        <td><span>No messages found!</span></td>
      </tr>
      <tr *ngFor="let message of executionInfo.messages" class="clickable">
        <td><span [class]="message.type == 'OUTBOUND' ? 'badge badge-primary' : 'badge badge-success'" [textContent]="message.type == 'OUTBOUND' ? 'OUT' : 'IN'" style="min-width: 3em;"></span></td>
        <td class="test-message" [message]="message"></td>
      </tr>
      </tbody>
    </table>
  </div>

  <h2 class="sub-header">Latest results</h2>

  <test-progress
      *ngIf="executionInfo.running || executionInfo.completed == 100"
      [completed]="executionInfo.completed" [failed]="failed">
  </test-progress>
  <test-result-outlet *ngIf="!running"></test-result-outlet>
</div>
<ng-template #noExecution>
  <h1>Please run tests to see results</h1>
</ng-template>
<div class="dialog" *ngIf="executionInfo"
     dialog-id="dialog-console"
     dialog-title="Console log output"
     dialog-confirm="no"
     dialog-size="lg">
  <pre class="logger" [textContent]="executionInfo.processOutput"></pre>

</div>